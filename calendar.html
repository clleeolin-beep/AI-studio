<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æƒ‡é™½è¡Œç¨‹ç®¡ç†ç³»çµ±</title>
    <style>
        :root { --wine-red: #800020; --sidebar-bg: #ffffff; }
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; font-family: 'Microsoft JhengHei', sans-serif; display: flex; overflow: hidden; }
        
        /* å´é‚Šæ¬„å›ºå®šå¯¬åº¦ */
        .sidebar {
            width: 240px;
            background: var(--sidebar-bg);
            border-right: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            padding: 20px 15px;
            box-sizing: border-box;
            flex-shrink: 0;
            overflow-y: auto;
        }

        .sidebar-title { color: var(--wine-red); font-weight: bold; margin-bottom: 15px; font-size: 18px; border-bottom: 2px solid var(--wine-red); padding-bottom: 8px; }
        
        /* æœå°‹æ¡† */
        .search-box { margin-bottom: 20px; }
        .search-box input { width: 100%; padding: 10px; border: 1px solid #cbd5e1; border-radius: 6px; box-sizing: border-box; font-size: 14px; outline: none; }
        .search-box input:focus { border-color: var(--wine-red); }

        /* æŒ‰éˆ•ç¾¤çµ„æ¨™é¡Œ */
        .group-label { font-size: 12px; color: #94a3b8; margin: 10px 0 5px 0; font-weight: bold; }

        /* æŒ‰éˆ•æ¨£å¼ */
        .btn-group { display: flex; flex-direction: column; gap: 8px; margin-bottom: 20px; }
        .filter-btn { 
            padding: 10px; background: #fff; border: 1px solid #e2e8f0; border-radius: 8px; 
            cursor: pointer; text-align: center; transition: all 0.2s; color: #334155; font-size: 14px; font-weight: 500;
        }
        .filter-btn:hover { background: #fff1f2; border-color: var(--wine-red); color: var(--wine-red); }
        .filter-btn.active { background: var(--wine-red); color: white; border-color: var(--wine-red); box-shadow: 0 4px 6px rgba(128, 0, 32, 0.15); }

        /* å…¨å¹…æ—¥æ›†å€åŸŸ */
        .main-content { flex-grow: 1; height: 100%; position: relative; background: #fff; }
        iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        
        .reset-link { font-size: 13px; color: #94a3b8; cursor: pointer; text-decoration: underline; text-align: center; padding: 15px 0; }
    </style>
</head>
<body>

    <div class="sidebar">
        <div class="sidebar-title">è¡Œç¨‹ç¯©é¸</div>
        
        <div class="search-box">
            <input type="text" id="calSearch" placeholder="æœå°‹é—œéµå­—å¾ŒæŒ‰ Enter" onkeypress="if(event.key==='Enter') handleSearch()">
        </div>

        <div class="group-label">å­¸é•·å§è¡Œç¨‹</div>
        <div class="btn-group">
            <button class="filter-btn" onclick="applyFilter('ç´ è', this)">ç´ èå­¸å§Š</button>
            <button class="filter-btn" onclick="applyFilter('è³¢æ­£', this)">è³¢æ­£å­¸é•·</button>
            <button class="filter-btn" onclick="applyFilter('æ½”æ•', this)">æ½”æ•å­¸å§Š</button>
            <button class="filter-btn" onclick="applyFilter('è©©çŠ', this)">è©©çŠå­¸å§Š</button>
            <button class="filter-btn" onclick="applyFilter('æ—­è¯', this)">æ—­è¯å­¸é•·</button>
            <button class="filter-btn" onclick="applyFilter('å®—éœ–', this)">å®—éœ–å­¸é•·</button>
        </div>

        <div class="group-label">åˆ†é¡è¡Œç¨‹</div>
        <div class="btn-group">
            <button class="filter-btn" onclick="applyFilter('å…¬å‡', this)">ğŸ’¼ å…¬å‡</button>
            <button class="filter-btn" onclick="applyFilter('æœƒè­°', this)">ğŸ“… æœƒè­°</button>
        </div>

        <div class="reset-link" onclick="applyFilter('', null)">é¡¯ç¤ºå…¨éƒ¨è¡Œç¨‹</div>
    </div>

    <div class="main-content">
        <iframe id="calendar-frame" name="calendar-frame"></iframe>
    </div>

    <script>
        const CAL_ID = 'l7tc3ugm2jetlhr9frfpdplqlc@group.calendar.google.com';
        
        // æ ¸å¿ƒè¼‰å…¥å‡½æ•¸ï¼šåˆ©ç”¨éš¨æ©Ÿæ•¸é˜²æ­¢ç€è¦½å™¨å¿«å–èˆŠçš„ç¯©é¸çµæœ
        function updateCalendar(keyword = '') {
            const frame = document.getElementById('calendar-frame');
            let baseUrl = "https://calendar.google.com/calendar/embed";
            let params = new URLSearchParams({
                src: CAL_ID,
                ctz: 'Asia/Taipei',
                wkst: 1,
                bgcolor: '#ffffff',
                color: '#800020',
                showTitle: 0,
                showNav: 1,
                showPrint: 0,
                showTabs: 1,
                showCalendars: 0,
                mode: 'MONTH'
            });

            if (keyword) {
                params.append('q', keyword);
            }
            
            // åŠ å…¥æ™‚é–“æˆ³å¼·åˆ¶é‡åˆ·
            params.append('t', new Date().getTime());

            const finalUrl = `${baseUrl}?${params.toString()}`;
            
            // ä½¿ç”¨ location.replace æ˜¯ç›®å‰ Iframe ç¯©é¸æœ€ç©©å®šçš„åšæ³•
            frame.contentWindow.location.replace(finalUrl);
        }

        function applyFilter(keyword, btn) {
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            if (btn) btn.classList.add('active');
            
            document.getElementById('calSearch').value = keyword;
            updateCalendar(keyword);
        }

        function handleSearch() {
            const keyword = document.getElementById('calSearch').value;
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            updateCalendar(keyword);
        }

        // åˆå§‹åŒ–
        window.onload = () => updateCalendar();
    </script>
</body>
</html>
